print(summary(eq.LSDV)[1:3,])
print(summary(eq.LSDV)$coefficients[1:3,])
print(summary(eq.pooled)$coefficients)
data("CigarettesSW", package = "AER")
CigarettesSW$rprice  <- with(CigarettesSW, price/cpi)
CigarettesSW$rincome <- with(CigarettesSW, income/population/cpi)
T <- length(levels(CigarettesSW$year))
n <- length(levels(CigarettesSW$state))
eq.pooled <- lm(log(packs)~log(rprice)+log(rincome),data=CigarettesSW)
print(summary(eq.pooled)$coefficients)
eq.LSDV <- lm(log(packs)~log(rprice)+log(rincome)+state,data=CigarettesSW)
print(summary(eq.LSDV)$coefficients[1:3,])
names(CigarettesSW)
class(CigarettesSW$year)
markdown::pandoc_version()
library(kableExtra)
install.packages("kableExtra")
library(kableExtra)
data("EmplUK", package = "plm")
install.packages("plm")
library(plm)
install.packages(collapse)
install.packages("collapse")
library(plm)
data("EmplUK", package = "plm")
dim(EmplUK)
head(EmplUK)
par(mar = c(4, 4, .1, .1))
plot(pressure, type = 'b', pch = 19)
source("~/Dropbox/Teaching/Structural shocks/RCodes/Code_SR_and_LR.R")
setwd("~/Dropbox/Teaching/GraduateInstitute/Cours_Bookdown")
source("~/Dropbox/Teaching/Structural shocks/RCodes/Code_SR_and_LR.R")
getwd()
setwd("~/Dropbox/Teaching/GraduateInstitute/Cours_Bookdown")
setwd("~/Dropbox/Teaching/GraduateInstitute/Cours_Bookdown")
y <- rexp(200,rate = 1/3)
rug(y,col="red")
y <- rexp(200,rate = 1/3)
rug(y,col="red")
c(expression(paste(lambda," = 1"),sep=""),
expression(paste(lambda," = 3"),sep=""),
expression(paste(lambda," = 5"),sep=""),
expression(paste(lambda," = 7"),sep=""))
y <- rexp(200,rate = 1/3)
hist(y,xlim=c(0,12),ylim=c(0,1),
freq = FALSE,breaks = 20,xlab="",ylab="",main="",col="white")
x <- seq(0,12,by=.01)
lambda = 1
par(new=TRUE)
plot(x,1/lambda * exp(-x/lambda),type="l",lwd=2,
ylim=c(0,1),
xlab="time period between two arrivals",
ylab="density")
rug(y,col="red")
lambda = 3
lines(x,1/lambda * exp(-x/lambda),type="l",lwd=2,col="blue")
lambda = 5
lines(x,1/lambda * exp(-x/lambda),type="l",lwd=2,col="red")
lambda = 7
lines(x,1/lambda * exp(-x/lambda),type="l",lwd=2,col="green")
legend("topright", # places a legend at the appropriate place c("Health","Defense"), # puts text in the legend
c(expression(paste(lambda," = 1"),sep=""),
expression(paste(lambda," = 3"),sep=""),
expression(paste(lambda," = 5"),sep=""),
expression(paste(lambda," = 7"),sep="")),
lty=c(1,1,1,1), # gives the legend appropriate symbols (lines)
lwd=c(2,2,2,2), # line width
col=c("black","blue","red","green"),
seg.len=3)
y <- rexp(200,rate = 1/3)
par(plt=c(.15,.15,.95,.95))
hist(y,xlim=c(0,12),ylim=c(0,1),
freq = FALSE,breaks = 20,xlab="",ylab="",main="",col="white")
log.f <- function(y,lambda){
return(sum(log(1/lambda*exp(-y/lambda))))
}
y <- c(1.1,2.2,0.7,5)
all.log.f <- NULL
all.lambda <- seq(.1,10,by=.1)
for(lambda in all.lambda){
all.log.f <- c(all.log.f,log.f(y,lambda))
}
par(plt=c(.15,.95,.2,.85))
plot(all.lambda,exp(all.log.f),type="l",lwd=2,xlab="lambda",ylab="Probability")
abline(v=all.lambda[which(all.log.f==max(all.log.f))],col="red")
log.f <- function(y,lambda){
return(sum(log(1/lambda*exp(-y/lambda))))
}
y <- c(1.1,2.2,0.7,5)
all.log.f <- NULL
all.lambda <- seq(.1,10,by=.1)
for(lambda in all.lambda){
all.log.f <- c(all.log.f,log.f(y,lambda))
}
par(plt=c(.15,.95,.2,.85))
plot(all.lambda,exp(all.log.f),type="l",lwd=2,xlab="lambda",ylab="Probability")
abline(v=all.lambda[which(all.log.f==max(all.log.f))],col="red")
smi_data <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv")
dim(smi_data)
smi_data$Date
smi_data$Date <- as.Date(smi_data$Date,"%m/%d/%y")
smi_data$Date
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
smi$Close[(1+h):T]
smi[,2]
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",dec = ".")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
smi$Close
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",dec = ".",header = TRUE)
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
names(smi)
smi$Close
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
plot(smi$Date[(h+1):T],r,type="l")
dev.off()
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
window <- 5
flag <- 1
first.t <- 2
vec.means <- NULL
indic.dates <- NULL
while(flag==1){
smpl <- r[first.t:(first.t+window-1)]
vec.means <- c(vec.means,mean(smpl))
indic.dates <- c(indic.dates,first.t)
first.t <- first.t + window
if(first.t+window>T){
flag <- 0
}
}
r <- vec.means
par(mfrow=c(1,2))
plot(smi$Date[indic.dates],r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=mu+2*sigma,lty=3,col="blue")
mean(r)
mean(r,na.rm = TRUE)
mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE)
plot(smi$Date[indic.dates],r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
plot(smi$Date[indic.dates],r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
r <- r[seq(1,T,by=5)] # weekly returns
par(mfrow=c(1,2))
plot(smi$Date[indic.dates],r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
indic.dates <- seq(1,T,by=5)  # weekly returns
r <- r[indic.dates]
par(mfrow=c(1,2))
plot(smi$Date[indic.dates],r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
# Likelihood function
f <- function(theta,x){
mu.1 <- theta[1]
mu.2 <- theta[2]
sigma.1 <- theta[3]
sigma.2 <- theta[4]
p <- exp(theta[5])/(1+exp(theta[5]))
res <- p*1/sqrt(2*pi*sigma.1^2)*exp(-(x-mu.1)^2/(2*sigma.1^2)) +
(1-p)*1/sqrt(2*pi*sigma.2^2)*exp(-(x-mu.2)^2/(2*sigma.2^2))
return(res)
}
log.f <- function(theta){
res.f <- f(theta,r)
return(-sum(log(res.f)))
}
x <- r
MAXIT.NlMd <- 10000
res.optim <- optim(c(0,0,0.5,1.5,.5),log.f,
gr = NULL,
method="BFGS", # could be "Nelder-Mead"
control=list(trace=TRUE,maxit=MAXIT.NlMd),hessian=TRUE)
# Likelihood function
f <- function(theta,y){
mu.1 <- theta[1]
mu.2 <- theta[2]
sigma.1 <- theta[3]
sigma.2 <- theta[4]
p <- exp(theta[5])/(1+exp(theta[5]))
res <- p*1/sqrt(2*pi*sigma.1^2)*exp(-(y-mu.1)^2/(2*sigma.1^2)) +
(1-p)*1/sqrt(2*pi*sigma.2^2)*exp(-(y-mu.2)^2/(2*sigma.2^2))
return(res)
}
log.f <- function(theta,y){
res.f <- f(theta,y)
return(-sum(log(res.f)))
}
MAXIT.NlMd <- 10000
res.optim <- optim(c(0,0,0.5,1.5,.5),log.f,
y=r,
gr = NULL,
method="BFGS", # could be "Nelder-Mead"
control=list(trace=TRUE,maxit=MAXIT.NlMd),hessian=TRUE)
r
f <- function(theta,y){
mu.1 <- theta[1]
mu.2 <- theta[2]
sigma.1 <- theta[3]
sigma.2 <- theta[4]
p <- exp(theta[5])/(1+exp(theta[5]))
res <- p*1/sqrt(2*pi*sigma.1^2)*exp(-(y-mu.1)^2/(2*sigma.1^2)) +
(1-p)*1/sqrt(2*pi*sigma.2^2)*exp(-(y-mu.2)^2/(2*sigma.2^2))
return(res)
}
log.f <- function(theta,y){
res.f <- f(theta,y)
return(-sum(log(res.f)))
}
MAXiter <- 1000
res.optim <- optim(c(0,0,0.5,1.5,.5),
log.f,
y=r,
gr = NULL,
method="BFGS", # could be "Nelder-Mead"
control=list(trace=TRUE,maxit=MAXiter),hessian=TRUE)
c(0,0,0.5,1.5,.5)
log.f(c(0,0,0.5,1.5,.5))
log.f(c(0,0,0.5,1.5,.5),r)
is.na(r)
sum(is.na(r))
r
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
indic.dates <- seq(1,T,by=5)  # weekly returns
r <- !is.na(r[indic.dates])
par(mfrow=c(1,2))
plot(smi$Date[indic.dates],r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
f <- function(theta,y){ # Likelihood function
mu.1 <- theta[1]; mu.2 <- theta[2]
sigma.1 <- theta[3]; sigma.2 <- theta[4]
p <- exp(theta[5])/(1+exp(theta[5]))
res <- p*1/sqrt(2*pi*sigma.1^2)*exp(-(y-mu.1)^2/(2*sigma.1^2)) +
(1-p)*1/sqrt(2*pi*sigma.2^2)*exp(-(y-mu.2)^2/(2*sigma.2^2))
return(res)
}
log.f <- function(theta,y){ #log-Likelihood function
return(-sum(log(f(theta,y))))
}
MAXiter <- 1000
res.optim <- optim(c(0,0,0.5,1.5,.5),
log.f,
y=r,
method="BFGS", # could be "Nelder-Mead"
control=list(trace=TRUE,maxit=MAXiter),hessian=TRUE)
theta <- res.optim$par
res.optim$hessian
# Hessian approach:
J <- res.optim$hessian
I.1 <- solve(J)
# Outer-product of gradient approach:
log.f.0 <- log(f(theta,r))
epsilon <- .00000001
d.log.f <- NULL
for(i in 1:length(theta)){
theta.i <- theta
theta.i[i] <- theta.i[i] + epsilon
log.f.i <- log(f(theta.i,r))
d.log.f <- cbind(d.log.f,
(log.f.i - log.f.0)/epsilon)
}
V <- t(d.log.f) %*% d.log.f
I.2 <- solve(t(d.log.f) %*% d.log.f)
d.log.f
dim(d.log.f)
length(r)
J
dim(log.f.0)
length(log.f.0)
theta
dim8d.log.f
dim(d.log.f)
V <- t(d.log.f) %*% d.log.f
dim(V)
solve(V)
eigen(V)
theta
plot(r)
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
indic.dates <- seq(1,T,by=5)  # weekly returns
r <- !is.na(r[indic.dates])
par(mfrow=c(1,1))
plot(smi$Date[indic.dates],r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
r
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
r
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
indic.dates <- seq(1,T,by=5)  # weekly returns
r <- r[!is.na(r[indic.dates])]
par(mfrow=c(1,1))
plot(smi$Date[indic.dates],r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
r <- r[!is.na(r[indic.dates])]
indic.dates <- seq(1,T,by=5)  # weekly returns
par(mfrow=c(1,1))
plot(smi$Date[indic.dates],r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
r <- r[!is.na(r[indic.dates])]
indic.dates <- seq(1,T,by=5)  # weekly returns
r <- r[indic.dates]
par(mfrow=c(1,1))
plot(smi$Date[indic.dates],r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
dates <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
r <- r[!is.na(r)]; dates <- dates[!is.na(r)]
indic.dates <- seq(1,T,by=5)  # weekly returns
r <- r[indic.dates]; dates <- dates[indic.dates]
par(mfrow=c(1,1))
plot(dates,r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
r
sum(is.na(r))
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi <- complete.cases(smi)
dim(smi)
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
dim(smi)
smi <- complete.cases(smi)
dim(smi)
smi
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi <- smi[complete.cases(smi),]
smi
class(smi)
dim(smi)
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
dim(smi)
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi <- smi[complete.cases(smi),]
dates <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
indic.dates <- seq(1,T,by=5)  # weekly returns
r <- r[indic.dates]; dates <- dates[indic.dates]
par(mfrow=c(1,1))
plot(dates,r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
sum(is.na(r))
which(is.na(r))
r[1595]
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
smi$r <- c(rep(NaN,h),r)
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
smi$r <- c(rep(NaN,h),r)
indic.dates <- seq(1,T,by=5)  # weekly returns
smi <- smi[indic.dates,]
smi <- smi[complete.cases(smi),]
dates <- as.Date(smi$Date,"%m/%d/%y")
par(mfrow=c(1,1))
plot(dates,r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
smi$r <- c(rep(NaN,h),r)
indic.dates <- seq(1,T,by=5)  # weekly returns
smi <- smi[indic.dates,]
smi <- smi[complete.cases(smi),]
dates <- as.Date(smi$Date,"%m/%d/%y")
r <- smi$r
par(mfrow=c(1,1))
plot(dates,r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
dates <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
smi$r <- c(rep(NaN,h),r)
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
r <- 100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)]))
smi$r <- c(rep(NaN,h),r)
indic.dates <- seq(1,T,by=5)  # weekly returns
smi <- smi[indic.dates,]
par(mfrow=c(1,1))
plot(smi$Date,smi$r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
smi$r <- c(rep(NaN,h),
100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)])))
indic.dates <- seq(1,T,by=5)  # weekly returns
smi <- smi[indic.dates,]
smi <- smi[complete.cases(smi),]
par(mfrow=c(1,1))
plot(smi$Date,smi$r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(r,na.rm = TRUE)+2*sd(r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(r,na.rm = TRUE)-2*sd(r,na.rm = TRUE),lty=3,col="blue")
smi <- read.csv("https://raw.githubusercontent.com/jrenne/Data4courses/master/SMI/SMI.csv",
dec = ".",header = TRUE, na.strings = "null")
smi$Date <- as.Date(smi$Date,"%m/%d/%y")
T <- dim(smi)[1]
h <- 5 # holding period (one week)
smi$r <- c(rep(NaN,h),
100*c(log(smi$Close[(1+h):T]/smi$Close[1:(T-h)])))
indic.dates <- seq(1,T,by=5)  # weekly returns
smi <- smi[indic.dates,]
smi <- smi[complete.cases(smi),]
par(mfrow=c(1,1))
plot(smi$Date,smi$r,type="l",main="5-day return on SMI index",xlab="",ylab="in percent")
abline(h=0,col="blue")
abline(h=mean(smi$r,na.rm = TRUE)+2*sd(smi$r,na.rm = TRUE),lty=3,col="blue")
abline(h=mean(smi$r,na.rm = TRUE)-2*sd(smi$r,na.rm = TRUE),lty=3,col="blue")
