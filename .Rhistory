points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="light gray",border="white",lwd=3)
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
eq1 <- lm(price~bedrooms+accommodates+neighborhood,
data=airbnb)
eq2 <- lm(price~bedrooms+accommodates,
data=airbnb)
lmtest::coeftest(eq1)[1:2,]
lmtest::coeftest(eq2)[1:2,]
#vcov_cluster <- vcovCL(eq, cluster = JST[, c("iso")])
#coeftest(eq, vcov = vcov_cluster)[1:2,]
#vcov_cluster <- vcovCL(eq, cluster = JST[, c("iso","YEAR")])
#coeftest(eq, vcov = vcov_cluster)[1:2,]
eq1 <- lm(price~bedrooms+accommodates+neighborhood,
data=airbnb)
eq2 <- lm(price~bedrooms+accommodates,
data=airbnb)
library(stargazer)
stargazer(
eq1,eq2, type = "text", column.labels = c("No FE", "FE"),
omit = c("Constant", "bedrooms"),
omit.labels = c("Intercept", "bedrooms"),
keep.stat = "n")
stargazer(
+     eq1,eq2, type = "text", column.labels = c("No FE", "FE"),
+     omit = c("Constant", "neighborhood"),
stargazer(
+     eq1,eq2, type = "text", column.labels = c("No FE", "FE"),
+     omit = c("Constant", "bedrooms"),
stargazer(
eq1,eq2, type = "text", column.labels = c("No FE", "FE"),
omit = c("Constant", "bedrooms"),
omit.labels = c("Intercept", "bedrooms"),
keep.stat = "n")
stargazer(
eq1,eq2, type = "text", column.labels = c("No FE", "FE"),
omit = c("Constant", "bedrooms"),
omit.labels = c("Intercept", "bedrooms"),
keep.stat = "n")
stargazer(
eq1,eq2, type = "text", column.labels = c("No FE", "FE"),
omit = c("Constant", "neighborhood"),
omit.labels = c("Intercept", "bedrooms"),
keep.stat = "n")
stargazer(
eq1,eq2, type = "text", column.labels = c("No FE", "FE"),
omit = c("Constant", "neighborhood"),
omit.labels = c("Intercept", "District FE"),
keep.stat = "n")
eq1 <- lm(price~bedrooms+accommodate,data=airbnb)
eq1 <- lm(price~bedrooms+accommodatess,data=airbnb)
eq1 <- lm(price~bedrooms+accommodates,data=airbnb)
eq2 <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
stargazer(
eq1,eq2, type = "text", column.labels = c("No FE", "FE"),
omit = c("Constant", "neighborhood"),
omit.labels = c("Intercept", "District FE"),
keep.stat = "n")
stargazer(
eq2,eq1, type = "text", column.labels = c("No FE", "FE"),
omit = c("Constant", "neighborhood"),
omit.labels = c("Intercept", "District FE"),
keep.stat = "n")
stargazer(
eq2,eq1, type = "text", column.labels = c("FE", "No FE"),
omit = c("Constant", "neighborhood"),
omit.labels = c("Intercept", "District FE"),
keep.stat = "n")
eq1 <- lm(price~bedrooms+accommodates,data=airbnb)
eq2 <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
stargazer(
eq2,eq1, type = "text", column.labels = c("FE", "No FE"),
omit = c("neighborhood"),
omit.labels = c("District FE"),
keep.stat = "n")
stargazer(
eq2,eq1, type = "text", column.labels = c("FE", "No FE"),
omit = c("neighborhood"),
omit.labels = c("District FE"),#keep.stat = "n"
)
stargazer(
eq2,eq1, type = "text", column.labels = c("FE", "No FE"),
omit = c("neighborhood"),
omit.labels = c("District FE")#,keep.stat = "n"
)
eq_noFE <- lm(price~bedrooms+accommodates,data=airbnb)
eq_FE <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
stargazer(
eq_FE,eq_noFE, type = "text", column.labels = c("FE", "No FE"),
omit = c("neighborhood"),
omit.labels = c("District FE")#,keep.stat = "n"
)
lmtest::coeftest(eq_FE)[1:2,]
lmtest::coeftest(eq_noFE)[1:2,]
# Adjust standard errors
cov_FE          <- vcovHC(eq_FE, type = "HC1")
robust_se_FE    <- sqrt(diag(cov_FE))
cov_noFE        <- vcovHC(eq_noFE, type = "HC1")
robust_se_noFE  <- sqrt(diag(cov_noFE))
# Stargazer output (with and without RSE)
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),keep.stat = "n",
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="light gray",border="white",lwd=3)
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
eq_noFE <- lm(price~bedrooms+accommodates,data=airbnb)
eq_FE <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
stargazer(
eq_FE,eq_noFE, type = "text", column.labels = c("FE", "No FE"),
omit = c("neighborhood"),
omit.labels = c("District FE")#,keep.stat = "n"
)
# XXXXX
lmtest::coeftest(eq_FE)[1:2,]
lmtest::coeftest(eq_noFE)[1:2,]
# Adjust standard errors
cov_FE          <- vcovHC(eq_FE, type = "HC1")
robust_se_FE    <- sqrt(diag(cov_FE))
cov_noFE        <- vcovHC(eq_noFE, type = "HC1")
robust_se_noFE  <- sqrt(diag(cov_noFE))
# Stargazer output (with and without RSE)
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),keep.stat = "n",
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="light gray",border="white",lwd=3)
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
eq_noFE <- lm(price~bedrooms+accommodates,data=airbnb)
eq_FE <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
stargazer(
eq_FE,eq_noFE, type = "text", column.labels = c("FE", "No FE"),
omit = c("neighborhood"),
omit.labels = c("District FE")#,keep.stat = "n"
)
# XXXXX
lmtest::coeftest(eq_FE)[1:2,]
lmtest::coeftest(eq_noFE)[1:2,]
# Adjust standard errors
cov_FE          <- vcovHC(eq_FE, type = "HC1")
robust_se_FE    <- sqrt(diag(cov_FE))
cov_noFE        <- vcovHC(eq_noFE, type = "HC1")
robust_se_noFE  <- sqrt(diag(cov_noFE))
# Stargazer output (with and without RSE)
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),keep.stat = "n",
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
lmtest::coeftest(eq_FE)[1:2,]
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),keep.stat = "n",
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
library(stargazer)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="light gray",border="white",lwd=3)
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
eq_noFE <- lm(price~bedrooms+accommodates,data=airbnb)
eq_FE <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
# stargazer(
#   eq_FE,eq_noFE, type = "text", column.labels = c("FE", "No FE"),
#   omit = c("neighborhood"),
#   omit.labels = c("District FE")#,keep.stat = "n"
# )
# lmtest::coeftest(eq_FE)[1:2,]
# lmtest::coeftest(eq_noFE)[1:2,]
# Adjust standard errors
cov_FE          <- vcovHC(eq_FE, type = "HC1")
robust_se_FE    <- sqrt(diag(cov_FE))
cov_noFE        <- vcovHC(eq_noFE, type = "HC1")
robust_se_noFE  <- sqrt(diag(cov_noFE))
# Stargazer output (with and without RSE)
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),keep.stat = "n",
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
par(mar=c(0,0,0,0))
plot(zurich_districts,col="light gray",border="white",lwd=3)
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
dev.off()
dev.off()
par(mar=c(0,0,0,0))
plot(zurich_districts,col="light gray",border="white",lwd=3)
plot(rnorm(10))
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
library(stargazer)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="light gray",border="white",lwd=3)
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
library(stargazer)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="light gray",border="white",lwd=3)
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
eq_noFE <- lm(price~bedrooms+accommodates,data=airbnb)
eq_FE <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
# stargazer(
#   eq_FE,eq_noFE, type = "text", column.labels = c("FE", "No FE"),
#   omit = c("neighborhood"),
#   omit.labels = c("District FE")#,keep.stat = "n"
# )
# lmtest::coeftest(eq_FE)[1:2,]
# lmtest::coeftest(eq_noFE)[1:2,]
# Adjust standard errors
cov_FE          <- vcovHC(eq_FE, type = "HC1")
robust_se_FE    <- sqrt(diag(cov_FE))
cov_noFE        <- vcovHC(eq_noFE, type = "HC1")
robust_se_noFE  <- sqrt(diag(cov_noFE))
# Stargazer output (with and without RSE)
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),keep.stat = "n",
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
plot(zurich_districts,col="light gray",border="white",lwd=3)
plot(zurich_districts,col="light gray",border="white",lwd=3)
plot(rnorm(10))
par(mar=c(0,0,0,0))
plot(zurich_districts,col="light gray",border="white",lwd=3)
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
library(stargazer)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="light gray",border="white",lwd=3)
plot(rnorm(10))
zurich_districts
plot(zurich_districts)
plot(zurich_districts,col="light gray",border="white",lwd=3)
plot(zurich_districts,col="gray",border="white",lwd=3)
plot(zurich_districts,border="white",lwd=3)
plot(zurich_districts,border="grey",lwd=3)
plot(zurich_districts)
plot(zurich_districts,col="blue")
plot(zurich_districts,col="gray")
plot(zurich_districts,col="gray",border=NA)
plot(zurich_districts,col="gray",border="white")
plot(zurich_districts,col="gray",border="white",lwd=3)
plot(zurich_districts,col="gray",border="white")
plot(zurich_districts,col="gray",border="white")
plot(zurich_districts,col="gray")
plot(zurich_districts,col="gray",border="white")
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
library(stargazer)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="gray",border="white")
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
eq_noFE <- lm(price~bedrooms+accommodates,data=airbnb)
eq_FE <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
# stargazer(
#   eq_FE,eq_noFE, type = "text", column.labels = c("FE", "No FE"),
#   omit = c("neighborhood"),
#   omit.labels = c("District FE")#,keep.stat = "n"
# )
# lmtest::coeftest(eq_FE)[1:2,]
# lmtest::coeftest(eq_noFE)[1:2,]
# Adjust standard errors
cov_FE          <- vcovHC(eq_FE, type = "HC1")
robust_se_FE    <- sqrt(diag(cov_FE))
cov_noFE        <- vcovHC(eq_noFE, type = "HC1")
robust_se_noFE  <- sqrt(diag(cov_noFE))
# Stargazer output (with and without RSE)
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),keep.stat = "n",
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
library(stargazer)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="gray",border="white")
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
eq_noFE <- lm(price~bedrooms+accommodates,data=airbnb)
eq_FE <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
# stargazer(
#   eq_FE,eq_noFE, type = "text", column.labels = c("FE", "No FE"),
#   omit = c("neighborhood"),
#   omit.labels = c("District FE")#,keep.stat = "n"
# )
# lmtest::coeftest(eq_FE)[1:2,]
# lmtest::coeftest(eq_noFE)[1:2,]
# Adjust standard errors
cov_FE          <- vcovHC(eq_FE, type = "HC1")
robust_se_FE    <- sqrt(diag(cov_FE))
cov_noFE        <- vcovHC(eq_noFE, type = "HC1")
robust_se_noFE  <- sqrt(diag(cov_noFE))
# Stargazer output (with and without RSE)
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),keep.stat = "n",
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
plot(zurich_districts,col="gray",border="white")
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,
cex=(abs(eq_FE$residuals[i])/100),
col=abs(eq_FE$residuals[i]))
}
plot(zurich_districts,col="gray",border="white")
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,
cex=(abs(eq_FE$residuals[i])/100),
col=abs(eq_FE$residuals[i]))
plot(zurich_districts,col="gray",border="white")
plot(zurich_districts,col="gray",border="white")
points(airbnb$longitude[1],airbnb$latitude[1])
points(airbnb$longitude[1],airbnb$latitude[1],cex=1)
points(airbnb$longitude[1],airbnb$latitude[1],cex=2)
points(airbnb$longitude[1],airbnb$latitude[1],cex=2,col=1)
points(airbnb$longitude[1],airbnb$latitude[1],cex=2,col=2)
rainbow(nb_district, start=.01,alpha=.4)
rainbow(10, start=.01,alpha=.4)
rainbow(10, start=.01, end=.02,alpha=.4)
install.packages(RColorBrewer)
install.packages("RColorBrewer")
library(RColorBrewer)
brewer.pal(n = 8, name = "RdBu")
display.brewer.pal(n = 8, name = 'RdBu')
plot(zurich_districts,col="gray",border="white")
plot(zurich_districts,col="gray",border="white")
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,
cex=(abs(eq_FE$residuals[i])/100),
col=abs(eq_FE$residuals[i]))
plot(zurich_districts,col="gray",border="white")
points(airbnb$longitude[i],airbnb$latitude[i])
plot(zurich_districts,col="gray",border="white")
points(airbnb$longitude[i],airbnb$latitude[i])
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
library(stargazer)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="gray",border="white")
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
eq_noFE <- lm(price~bedrooms+accommodates,data=airbnb)
eq_FE <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
# stargazer(
#   eq_FE,eq_noFE, type = "text", column.labels = c("FE", "No FE"),
#   omit = c("neighborhood"),
#   omit.labels = c("District FE")#,keep.stat = "n"
# )
# lmtest::coeftest(eq_FE)[1:2,]
# lmtest::coeftest(eq_noFE)[1:2,]
# Adjust standard errors
cov_FE          <- vcovHC(eq_FE, type = "HC1")
robust_se_FE    <- sqrt(diag(cov_FE))
cov_noFE        <- vcovHC(eq_noFE, type = "HC1")
robust_se_noFE  <- sqrt(diag(cov_noFE))
# Stargazer output (with and without RSE)
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),keep.stat = "n",
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
# Plot residuals
par(mfrow=c(1,2))
plot(zurich_districts,col="gray",border="white")
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,
cex=(abs(eq_FE$residuals[i])/100))
}
brewer.pal(n = 8, name = "RdBu")
categ <- round(20*(resid_FE - min(resid_FE))/(max(resid_FE)-min(resid_FE)))+1
nb_categ <- 20
categ <- round(20*(resid_FE - min(resid_FE))/(max(resid_FE)-min(resid_FE)))+1
resid_FE <- eq_FE$residuals
nb_categ <- 20
categ <- round(20*(resid_FE - min(resid_FE))/(max(resid_FE)-min(resid_FE)))+1
categ
min(categ)
max(categ)
resid_FE <- eq_FE$residuals
nb_categ <- 20
categ <- round((nb_categ-1)*(resid_FE - min(resid_FE))/(max(resid_FE)-min(resid_FE)))+1
min(categ)
max(categ)
sum(is.na(categ))
colour <- brewer.pal(n = nb_categ, name = "RdBu")
?brewer.pal
library(RColorBrewer)
?brewer.pal
brewer.pal(n = nb_categ, name = "RdBu")
nb_categ <- 11
categ <- round((nb_categ-1)*(resid_FE - min(resid_FE))/(max(resid_FE)-min(resid_FE)))+1
colour <- brewer.pal(n = nb_categ, name = "RdBu")
colour
source("~/Dropbox/Teaching/MyRpackages/AEC/data-raw/Zurich_Airbnb/Prep_data_airbnb.R")
library(devtools)
install_github("jrenne/AEC",force=TRUE)
library(rgdal)
library(AEC)
library(sandwich)
library(lmtest)
library(stargazer)
library(RColorBrewer)
par(mar=c(0,0,0,0))
plot(zurich_districts,col="gray",border="white")
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=1,cex=(airbnb$price[i]/200))
}
eq_noFE <- lm(price~bedrooms+accommodates,data=airbnb)
eq_FE <- lm(price~bedrooms+accommodates+neighborhood,data=airbnb)
# stargazer(
#   eq_FE,eq_noFE, type = "text", column.labels = c("FE", "No FE"),
#   omit = c("neighborhood"),
#   omit.labels = c("District FE")#,keep.stat = "n"
# )
# lmtest::coeftest(eq_FE)[1:2,]
# lmtest::coeftest(eq_noFE)[1:2,]
# Adjust standard errors
cov_FE          <- vcovHC(eq_FE, type = "HC1")
robust_se_FE    <- sqrt(diag(cov_FE))
cov_noFE        <- vcovHC(eq_noFE, type = "HC1")
robust_se_noFE  <- sqrt(diag(cov_noFE))
# Stargazer output (with and without RSE)
stargazer(eq_FE, eq_noFE, eq_FE, eq_noFE, type = "text",
column.labels = c("FE (no HAC)", "No FE (no HAC)",
"FE (with HAC)", "No FE (with HAC)"),
omit = c("neighborhood"),
omit.labels = c("District FE"),keep.stat = "n",
se = list(NULL, NULL, robust_se_FE, robust_se_noFE))
# Plot residuals
par(mfrow=c(1,2))
for(j in 1:2){# with/without FE
par(plt=c(0,1,0,.8))
plot(zurich_districts,col="gray",border="white")
if(j==1){
residuals <- eq_FE$residuals
titl <- "(a) With FE"
}else{
residuals <- eq_noFE$residuals
titl <- "(b) Without FE"
}
# create categories based on resisuals:
nb_categ <- 11
categ <- round((nb_categ-1)*(residuals-min(residuals))/(max(residuals)-min(residuals)))+1
colour <- paste(brewer.pal(n = nb_categ, name = "RdBu"),"77",sep="")
for(i in 1:dim(airbnb)[1]){
points(airbnb$longitude[i],airbnb$latitude[i],pch=19,
cex=(abs(residuals[i])/100),col=colour[categ[i]])
}
}
